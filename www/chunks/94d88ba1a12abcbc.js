;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="10efdf12-a37b-7b5f-e82c-9e445f34f0fb")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,119172,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(390464),r=e.i(618566),i=e.i(515288),n=e.i(519455),l=e.i(776639),c=e.i(118294),o=e.i(284614),d=e.i(270756),x=e.i(972520),m=e.i(475254);let h=(0,m.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),u=(0,m.default)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);function g({title:e="Account Access Required",message:a="You need to be signed in to access your account.",feature:r="account"}){let[m,g]=(0,t.useState)(!1),[p,f]=(0,t.useState)("login");return(0,s.jsxs)("div",{className:"min-h-screen bg-darkBg flex items-center justify-center p-6",children:[(0,s.jsxs)(i.Card,{className:"bg-gray-800 border-gray-600 max-w-md w-full shadow-xl",children:[(0,s.jsxs)(i.CardHeader,{className:"text-center pb-4",children:[(0,s.jsx)("div",{className:"mx-auto mb-4 w-16 h-16 bg-gradient-to-br from-neonCyan to-neonPink rounded-full flex items-center justify-center",children:(0,s.jsx)(d.Lock,{className:"h-8 w-8 text-black"})}),(0,s.jsx)(i.CardTitle,{className:"text-2xl font-bold text-white mb-2",children:e}),(0,s.jsx)("p",{className:"text-gray-400 text-sm leading-relaxed",children:a})]}),(0,s.jsxs)(i.CardContent,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("h3",{className:"text-white font-semibold flex items-center gap-2",children:[(0,s.jsx)(o.User,{className:"h-5 w-5 text-neonCyan"}),"Access Your ",r.charAt(0).toUpperCase()+r.slice(1)]}),(0,s.jsxs)("ul",{className:"space-y-2 text-sm text-gray-300",children:[(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.ArrowRight,{className:"h-4 w-4 text-neonPink"}),"View and manage your profile"]}),(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.ArrowRight,{className:"h-4 w-4 text-neonPink"}),"Track your order history"]}),(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.ArrowRight,{className:"h-4 w-4 text-neonPink"}),"Update your personal information"]}),(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.ArrowRight,{className:"h-4 w-4 text-neonPink"}),"Faster checkout experience"]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)(n.Button,{onClick:()=>{f("login"),g(!0)},className:"w-full bg-neonCyan text-black hover:bg-cyan-400 font-semibold py-3 transition-all duration-200 hover:scale-105",children:[(0,s.jsx)(u,{className:"h-5 w-5 mr-2"}),"Sign In to Your Account"]}),(0,s.jsxs)(n.Button,{onClick:()=>{f("signup"),g(!0)},variant:"outline",className:"w-full border-neonPink text-neonPink hover:bg-neonPink hover:text-black font-semibold py-3 transition-all duration-200 hover:scale-105",children:[(0,s.jsx)(h,{className:"h-5 w-5 mr-2"}),"Create New Account"]})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Don't have an account? Sign up is quick and free!"})})]})]}),(0,s.jsx)(l.Dialog,{open:m,onOpenChange:g,children:(0,s.jsxs)(l.DialogContent,{className:"bg-gray-800 border-gray-600 max-w-md",children:[(0,s.jsx)(l.DialogHeader,{children:(0,s.jsx)(l.DialogTitle,{className:"text-white text-center",children:"login"===p?"Welcome Back!":"Join Little Latte Lane"})}),(0,s.jsx)(c.default,{setIsModalOpen:g})]})})]})}var p=e.i(390676),f=e.i(95187),b=(0,f.createServerReference)("702ac20a999f453f10ffc00a98ecfffdb7c444ab01",f.callServer,void 0,f.findSourceMapURL,"updateUserProfile"),y=(0,f.createServerReference)("60201550af238743c8a7e28791bba8e09cab180a84",f.callServer,void 0,f.findSourceMapURL,"cancelDraftOrder"),j=e.i(793479),N=e.i(487486),w=e.i(224273),v=e.i(59),C=e.i(602041),k=e.i(674675),_=e.i(705766),S=e.i(263488),A=e.i(343432),F=e.i(346897),P=e.i(150965),B=e.i(503116),E=e.i(350627),D=e.i(592930),O=e.i(356909),T=e.i(37727),L=e.i(269638),R=e.i(245423),I=e.i(867838),M=e.i(643531),U=e.i(63209);function $(){return"serviceWorker"in navigator?"PushManager"in window?"Notification"in window?{supported:!0}:{supported:!1,reason:"Notification API not supported in this browser"}:{supported:!1,reason:"Push notifications not supported in this browser"}:{supported:!1,reason:"Service workers not supported in this browser"}}function q(){return"Notification"in window?Notification.permission:"denied"}async function Y(){let e=$();if(!e.supported)return{permission:"denied",message:e.reason||"Push notifications not supported"};try{let e=await Notification.requestPermission();if("granted"===e)return{permission:e,message:"Notification permission granted! You will now receive updates."};if("denied"===e)return{permission:e,message:"Notification permission denied. You can enable it in browser settings."};return{permission:e,message:"Notification permission request dismissed."}}catch(e){return console.error("‚ùå Failed to request notification permission:",e),{permission:"denied",message:"Failed to request notification permission"}}}async function H(){try{let e=$();if(!e.supported)return{success:!1,message:e.reason||"Push notifications not supported"};let s=q();if("granted"!==s){let e=await Y();if("granted"!==e.permission)return{success:!1,message:e.message}}let t=await navigator.serviceWorker.ready,a=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(e){let s="=".repeat((4-e.length%4)%4),t=(e+s).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(t),r=new Uint8Array(a.length);for(let e=0;e<a.length;++e)r[e]=a.charCodeAt(e);return r}("BBlxoTKeJ7BBv-rXq8rRxoujjdvXrncQ8kC3KG3qMaW84hK45oq3lYww-FZulA6H8I4DhaI2geZHpTJIXVhyi-E")}),r=await fetch("/api/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:a.toJSON()})});if(!r.ok)throw Error(`Failed to save subscription: ${r.statusText}`);return await r.json(),{success:!0,message:"Successfully subscribed to push notifications!",subscription:a.toJSON()}}catch(e){return console.error("‚ùå Failed to subscribe to push notifications:",e),{success:!1,message:e instanceof Error?e.message:"Failed to subscribe to push notifications"}}}async function z(){try{let e=await navigator.serviceWorker.ready,s=await e.pushManager.getSubscription();if(!s)return{success:!0,message:"No active subscription found"};if(!await s.unsubscribe())throw Error("Failed to unsubscribe from push notifications");let t=await fetch("/api/notifications/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error(`Failed to remove subscription from server: ${t.statusText}`);return{success:!0,message:"Successfully unsubscribed from push notifications"}}catch(e){return console.error("‚ùå Failed to unsubscribe from push notifications:",e),{success:!1,message:e instanceof Error?e.message:"Failed to unsubscribe from push notifications"}}}async function J(){try{if(!$().supported)return{subscribed:!1};let e=q();if("granted"!==e)return{subscribed:!1};let s=await navigator.serviceWorker.ready,t=await s.pushManager.getSubscription();if(!t)return{subscribed:!1};return{subscribed:!0,subscription:t.toJSON()}}catch(e){return console.error("‚ùå Failed to check push subscription:",e),{subscribed:!1}}}async function X(){try{if(!(await J()).subscribed)return{success:!1,message:"Not subscribed to push notifications. Please enable notifications first."};let e=await fetch("/api/notifications/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"üéâ Test Notification",body:"If you can see this, push notifications are working perfectly!",notification_type:"promotional",category:"test",action_url:"/account",data:{test:!0,timestamp:Date.now()}})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to send test notification")}return await e.json(),{success:!0,message:"Test notification sent! Check your notifications."}}catch(e){return console.error("‚ùå Failed to send test notification:",e),{success:!1,message:e instanceof Error?e.message:"Failed to send test notification"}}}async function W(){try{let e=await fetch("/api/notifications/preferences");if(!e.ok)throw Error(`Failed to fetch preferences: ${e.statusText}`);let s=await e.json();return{success:!0,preferences:s.preferences}}catch(e){return console.error("‚ùå Failed to fetch notification preferences:",e),{success:!1,message:e instanceof Error?e.message:"Failed to fetch preferences"}}}async function K(e){try{let s=await fetch("/api/notifications/preferences",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error(`Failed to update preferences: ${s.statusText}`);return await s.json(),{success:!0,message:"Notification preferences updated successfully"}}catch(e){return console.error("‚ùå Failed to update notification preferences:",e),{success:!1,message:e instanceof Error?e.message:"Failed to update preferences"}}}e.i(247167);var V=e.i(929592);function Z({autoShow:e=!1,onPermissionGranted:a,onDismiss:r,trigger:i}){let[n,l]=(0,t.useState)(!1),[c,o]=(0,t.useState)(!1),[d,x]=(0,t.useState)(null),[m,h]=(0,t.useState)(!0);(0,t.useEffect)(()=>{let s=$();if(h(s.supported),s.supported||x({type:"error",text:s.reason||"Push notifications not supported"}),e&&s.supported&&"default"===q()){let e=localStorage.getItem("notification-prompt-dismissed");if(e){let s=new Date(e);if((Date.now()-s.getTime())/864e5<7)return}l(!0)}},[e]);let u=async()=>{o(!0),x(null);try{let e=await H();e.success?(x({type:"success",text:e.message}),setTimeout(()=>{l(!1),a?.()},2e3)):x({type:"error",text:e.message})}catch(e){x({type:"error",text:e instanceof Error?e.message:"Failed to enable notifications"})}finally{o(!1)}},g=()=>{localStorage.setItem("notification-prompt-dismissed",new Date().toISOString()),l(!1),r?.()},p=()=>{localStorage.setItem("notification-prompt-never","true"),l(!1),r?.()};return i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{onClick:()=>l(!0),children:i}),(0,s.jsx)(G,{isOpen:n,onClose:()=>l(!1),onEnable:u,onDismiss:g,onNeverAsk:p,isLoading:c,message:d,pushSupported:m})]}):(0,s.jsx)(G,{isOpen:n,onClose:()=>l(!1),onEnable:u,onDismiss:g,onNeverAsk:p,isLoading:c,message:d,pushSupported:m})}function G({isOpen:e,onClose:t,onEnable:a,onDismiss:r,onNeverAsk:i,isLoading:c,message:o,pushSupported:d}){return(0,s.jsx)(l.Dialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(l.DialogContent,{className:"sm:max-w-md bg-darkBg border-neonCyan/20",children:[(0,s.jsxs)(l.DialogHeader,{children:[(0,s.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-neonCyan/10",children:(0,s.jsx)(R.Bell,{className:"h-8 w-8 text-neonCyan"})}),(0,s.jsx)(l.DialogTitle,{className:"text-center text-2xl font-bold text-white",children:"Stay Updated!"}),(0,s.jsx)(l.DialogDescription,{className:"text-center text-gray-300",children:"Enable notifications to get real-time updates about your orders"})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(Q,{icon:(0,s.jsx)(M.Check,{className:"h-5 w-5 text-neonCyan"}),text:"Know when your order is being prepared"}),(0,s.jsx)(Q,{icon:(0,s.jsx)(M.Check,{className:"h-5 w-5 text-neonCyan"}),text:"Get notified when your order is ready"}),(0,s.jsx)(Q,{icon:(0,s.jsx)(M.Check,{className:"h-5 w-5 text-neonCyan"}),text:"Receive exclusive offers and promotions"}),(0,s.jsx)(Q,{icon:(0,s.jsx)(M.Check,{className:"h-5 w-5 text-neonCyan"}),text:"Stay informed about special events"})]}),o&&(0,s.jsxs)(V.Alert,{className:"success"===o.type?"border-green-500/50 bg-green-500/10":"error"===o.type?"border-red-500/50 bg-red-500/10":"border-blue-500/50 bg-blue-500/10",children:[(0,s.jsx)(U.AlertCircle,{className:"h-4 w-4"}),(0,s.jsx)(V.AlertDescription,{className:"text-white",children:o.text})]}),!d&&(0,s.jsxs)(V.Alert,{className:"border-yellow-500/50 bg-yellow-500/10",children:[(0,s.jsx)(U.AlertCircle,{className:"h-4 w-4 text-yellow-500"}),(0,s.jsx)(V.AlertDescription,{className:"text-white",children:"Your browser doesn't support push notifications. Please try using a modern browser like Chrome, Firefox, or Safari."})]})]}),(0,s.jsxs)(l.DialogFooter,{className:"flex-col gap-2 sm:flex-col",children:[(0,s.jsx)(n.Button,{onClick:a,disabled:c||!d||o?.type==="success",className:"w-full bg-neonCyan text-darkBg font-bold hover:bg-neonCyan/90 disabled:opacity-50",children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"animate-spin mr-2",children:"‚è≥"}),"Enabling..."]}):o?.type==="success"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.Check,{className:"mr-2 h-4 w-4"}),"Enabled!"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.Bell,{className:"mr-2 h-4 w-4"}),"Enable Notifications"]})}),(0,s.jsxs)("div",{className:"flex w-full gap-2",children:[(0,s.jsx)(n.Button,{onClick:r,variant:"outline",className:"flex-1 border-gray-600 text-white hover:bg-gray-800",disabled:c,children:"Maybe Later"}),(0,s.jsx)(n.Button,{onClick:i,variant:"ghost",className:"flex-1 text-gray-400 hover:text-white hover:bg-gray-800",disabled:c,children:"Don't Ask Again"})]})]})]})})}function Q({icon:e,text:t}){return(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"mt-0.5",children:e}),(0,s.jsx)("p",{className:"text-sm text-gray-300",children:t})]})}var ee=e.i(110204),es=e.i(699375);let et=(0,m.default)("bell-off",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]]),ea=(0,m.default)("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);var er=e.i(531278);function ei(){let[e,a]=(0,t.useState)(!1),[r,i]=(0,t.useState)(!0),[l,c]=(0,t.useState)(!1),[o,d]=(0,t.useState)({push_enabled:!1,email_enabled:!1,sms_enabled:!1,order_updates_enabled:!0,promotional_enabled:!0,event_announcements_enabled:!0});(0,t.useEffect)(()=>{x()},[]);let x=async()=>{i(!0);try{let e=await J();a(e.subscribed);let s=await W();s.success&&s.preferences&&d(s.preferences)}catch(e){console.error("Failed to load notification settings:",e),_.default.error("Failed to load notification settings")}finally{i(!1)}},m=async()=>{c(!0);try{if(e){let e=await z();e.success?(a(!1),_.default.success("Push notifications disabled")):_.default.error(e.message)}else{let e=await H();e.success?(a(!0),_.default.success("Push notifications enabled!")):_.default.error(e.message)}}catch(e){_.default.error("Failed to update push notification settings")}finally{c(!1)}},h=async(e,s)=>{d({...o,[e]:s}),c(!0);try{let t=await K({[e]:s});t.success?_.default.success("Preference updated"):(d(o),_.default.error(t.message))}catch(e){d(o),_.default.error("Failed to update preference")}finally{c(!1)}},u=async()=>{if(!e)return void _.default.error("Please enable push notifications first");c(!0);try{let e=await X();e.success?_.default.success(e.message):_.default.error(e.message)}catch(e){_.default.error("Failed to send test notification")}finally{c(!1)}};return r?(0,s.jsx)("div",{className:"bg-gray-900/30 border border-gray-700 rounded-lg p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)(er.Loader2,{className:"h-8 w-8 text-neonCyan animate-spin"})})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-0 p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e?(0,s.jsx)(R.Bell,{className:"h-6 w-6 text-green-500 flex-shrink-0"}):(0,s.jsx)(et,{className:"h-6 w-6 text-gray-500 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"text-white font-semibold text-sm sm:text-base",children:"Push Notifications"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:e?"Enable to receive real-time updates":"Disabled"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 self-end sm:self-center",children:[(0,s.jsx)(N.Badge,{className:`text-xs ${e?"bg-green-600/20 text-green-300 border-green-600/50":"bg-gray-600/20 text-gray-300 border-gray-600/50"}`,children:e?"Enabled":"Disabled"}),(0,s.jsx)(es.Switch,{checked:e,onCheckedChange:m,className:"data-[state=checked]:bg-neonCyan"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-white font-semibold text-sm sm:text-base",children:"Notification Channels"}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2 xs:gap-0 p-3 sm:p-4 bg-gray-900/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(ee.Label,{htmlFor:"push_enabled",className:"text-white font-medium text-sm",children:"Push Notifications"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Receive notifications in your browser"})]}),(0,s.jsx)(es.Switch,{checked:o.push_enabled,onCheckedChange:e=>h("push_enabled",e),className:"data-[state=checked]:bg-neonCyan self-end xs:self-center"})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2 xs:gap-0 p-3 sm:p-4 bg-gray-900/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(ee.Label,{htmlFor:"email_enabled",className:"text-white font-medium text-sm",children:"Email Notifications"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Receive notifications via email"})]}),(0,s.jsx)(es.Switch,{checked:o.email_enabled,onCheckedChange:e=>h("email_enabled",e),className:"data-[state=checked]:bg-neonCyan self-end xs:self-center"})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2 xs:gap-0 p-3 sm:p-4 bg-gray-900/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(ee.Label,{htmlFor:"sms_enabled",className:"text-white font-medium text-sm",children:"SMS Notifications"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Receive notifications via text message"})]}),(0,s.jsx)(es.Switch,{checked:o.sms_enabled,onCheckedChange:e=>h("sms_enabled",e),className:"data-[state=checked]:bg-neonCyan self-end xs:self-center"})]})]}),(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-700",children:[(0,s.jsx)("h4",{className:"text-white font-semibold text-sm sm:text-base",children:"Notification Types"}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2 xs:gap-0 p-3 sm:p-4 bg-gray-900/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(ee.Label,{htmlFor:"order_updates",className:"text-white font-medium text-sm",children:"Order Updates"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Get notified when your order is being prepared and ready"})]}),(0,s.jsx)(es.Switch,{checked:o.order_updates_enabled,onCheckedChange:e=>h("order_updates_enabled",e),className:"data-[state=checked]:bg-neonCyan self-end xs:self-center"})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2 xs:gap-0 p-3 sm:p-4 bg-gray-900/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(ee.Label,{htmlFor:"promotional",className:"text-white font-medium text-sm",children:"Promotions & Offers"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Receive exclusive deals and special offers"})]}),(0,s.jsx)(es.Switch,{checked:o.promotional_enabled,onCheckedChange:e=>h("promotional_enabled",e),className:"data-[state=checked]:bg-neonCyan self-end xs:self-center"})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row xs:items-center xs:justify-between gap-2 xs:gap-0 p-3 sm:p-4 bg-gray-900/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)(ee.Label,{htmlFor:"events",className:"text-white font-medium text-sm",children:"Event Announcements"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Stay informed about special events and news"})]}),(0,s.jsx)(es.Switch,{checked:o.event_announcements_enabled,onCheckedChange:e=>h("event_announcements_enabled",e),className:"data-[state=checked]:bg-neonCyan self-end xs:self-center"})]})]}),e&&(0,s.jsx)("div",{className:"pt-4 border-t border-gray-700",children:(0,s.jsx)(n.Button,{onClick:u,disabled:l,variant:"outline",className:"w-full border-neonCyan text-neonCyan hover:bg-neonCyan/20 text-sm",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ea,{className:"mr-2 h-4 w-4"}),"Send Test Notification"]})})}),!e&&(0,s.jsxs)(V.Alert,{className:"border-blue-500/50 bg-blue-500/10",children:[(0,s.jsx)(U.AlertCircle,{className:"h-4 w-4 text-blue-500"}),(0,s.jsx)(V.AlertDescription,{className:"text-white text-xs sm:text-sm",children:"Enable push notifications to receive real-time updates about your orders. You can customize which types of notifications you want to receive above."})]}),e&&o.push_enabled&&(0,s.jsxs)(V.Alert,{className:"border-green-500/50 bg-green-500/10",children:[(0,s.jsx)(L.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)(V.AlertDescription,{className:"text-white text-xs sm:text-sm",children:"You're all set! You'll receive notifications based on your preferences."})]})]})}var en=e.i(87316),el=e.i(778917),ec=e.i(687130),eo=e.i(494913);function ed(){let[e,a]=(0,t.useState)([]),[r,l]=(0,t.useState)(!0),[c,o]=(0,t.useState)("all"),[d,x]=(0,t.useState)(null),m=(0,t.useCallback)(async()=>{try{l(!0),x(null);let e=(0,p.getSupabaseClient)(),{data:{user:s}}=await e.auth.getUser();if(!s)return void x("Not authenticated");let t=e.from("notification_history").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(50);"all"!==c&&(t=t.eq("notification_type",c));let{data:r,error:i}=await t;if(i){console.error("Error loading notification history:",i),x("Failed to load notification history");return}a(r||[])}catch(e){console.error("Error in loadNotifications:",e),x("An unexpected error occurred")}finally{l(!1)}},[c]);(0,t.useEffect)(()=>{m()},[m]);let h=async e=>{try{let s=(0,p.getSupabaseClient)(),{error:t}=await s.from("notification_history").update({read_at:new Date().toISOString()}).eq("id",e);if(t)return void console.error("Error marking notification as read:",t);a(s=>s.map(s=>s.id===e?{...s,read_at:new Date().toISOString()}:s))}catch(e){console.error("Error in markAsRead:",e)}},u=[{value:"all",label:"All Notifications",icon:R.Bell},{value:"order_status",label:"Order Updates",icon:P.ShoppingBag},{value:"promotional",label:"Promotions",icon:R.Bell},{value:"event_announcement",label:"Events",icon:en.Calendar}];return r?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(er.Loader2,{className:"h-8 w-8 text-neonCyan animate-spin"})}):d?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(U.AlertCircle,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-red-400 mb-2",children:d}),(0,s.jsx)(n.Button,{onClick:m,className:"bg-neonCyan text-black hover:bg-cyan-400",children:"Try Again"})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400 mr-2",children:[(0,s.jsx)(ec.Filter,{className:"h-4 w-4"}),"Filter:"]}),u.map(e=>{let t=e.icon;return(0,s.jsxs)(n.Button,{onClick:()=>o(e.value),variant:c===e.value?"default":"outline",size:"sm",className:c===e.value?"bg-neonCyan text-black hover:bg-cyan-400":"border-gray-600 text-gray-300 hover:bg-gray-700",children:[(0,s.jsx)(t,{className:"h-4 w-4 mr-1"}),e.label]},e.value)})]}),0===e.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(R.Bell,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:"No notifications yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"all"===c?"Your notification history will appear here":`No ${u.find(e=>e.value===c)?.label.toLowerCase()} found`})]}):(0,s.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,s.jsx)(i.Card,{className:`border transition-all ${e.read_at?"bg-gray-800 border-gray-700":"bg-gray-750 border-neonCyan/30 shadow-sm shadow-neonCyan/10"}`,children:(0,s.jsx)(i.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-1",children:(e=>{switch(e){case"order_status":return(0,s.jsx)(P.ShoppingBag,{className:"h-5 w-5 text-neonCyan"});case"promotional":return(0,s.jsx)(R.Bell,{className:"h-5 w-5 text-neonPink"});case"event_announcement":return(0,s.jsx)(en.Calendar,{className:"h-5 w-5 text-purple-400"});default:return(0,s.jsx)(R.Bell,{className:"h-5 w-5 text-gray-400"})}})(e.notification_type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-white text-sm",children:e.title}),e.clicked_at?(0,s.jsxs)(N.Badge,{className:"bg-green-600 text-white flex items-center gap-1",children:[(0,s.jsx)(el.ExternalLink,{className:"h-3 w-3"}),"Clicked"]}):e.read_at?(0,s.jsxs)(N.Badge,{className:"bg-blue-600 text-white flex items-center gap-1",children:[(0,s.jsx)(M.Check,{className:"h-3 w-3"}),"Read"]}):e.delivered_at?(0,s.jsxs)(N.Badge,{className:"bg-yellow-600 text-white flex items-center gap-1",children:[(0,s.jsx)(B.Clock,{className:"h-3 w-3"}),"Delivered"]}):"failed"===e.delivery_status?(0,s.jsxs)(N.Badge,{className:"bg-red-600 text-white flex items-center gap-1",children:[(0,s.jsx)(U.AlertCircle,{className:"h-3 w-3"}),"Failed"]}):(0,s.jsx)(N.Badge,{variant:"outline",className:"border-gray-500 text-gray-400",children:"Sent"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:e.body}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(e=>{if(!e)return"Unknown";try{return(0,eo.formatDistanceToNow)(new Date(e),{addSuffix:!0})}catch{return"Unknown"}})(e.sent_at||e.created_at)}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[!e.read_at&&(0,s.jsxs)(n.Button,{onClick:()=>h(e.id),size:"sm",variant:"ghost",className:"h-7 text-xs text-neonCyan hover:text-cyan-400 hover:bg-gray-700",children:[(0,s.jsx)(M.Check,{className:"h-3 w-3 mr-1"}),"Mark as read"]}),e.action_url&&(0,s.jsxs)(n.Button,{onClick:()=>{h(e.id),window.open(e.action_url,"_blank")},size:"sm",className:"h-7 text-xs bg-neonCyan text-black hover:bg-cyan-400",children:[(0,s.jsx)(el.ExternalLink,{className:"h-3 w-3 mr-1"}),"View"]})]})]})]})]})})},e.id))}),e.length>=50&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(n.Button,{variant:"outline",className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:"Load More"})})]})}function ex(){let{session:e,profile:l,user:c,refreshProfile:d}=(0,a.useAuth)(),x=(0,r.useRouter)(),{loadOrderToCart:m}=(0,k.useCartStore)(),[h,u]=(0,t.useState)([]),[f,M]=(0,t.useState)(!0),[U,$]=(0,t.useState)("active"),[q,Y]=(0,t.useState)({field:null,value:"",saving:!1}),[H,z]=(0,t.useState)(!1),[J,X]=(0,t.useState)(0),[W,K]=(0,t.useState)(!1),[V,G]=(0,t.useState)((0,C.parseAddressString)(null)),[Q,ee]=(0,t.useState)(null),[es,et]=(0,t.useState)(!1),[ea,er]=(0,t.useState)(0);(0,t.useEffect)(()=>{{let e=new URLSearchParams(window.location.search),s=e.get("payment"),t=e.get("order_id");e.get("payment_id");let a=e.get("tab");if(a&&["active","drafts","profile","orders"].includes(a)&&$(a),"success"===s){$("active"),_.default.success(`üéâ Payment successful! ${t?`Order #${t}`:"Your order"} has been confirmed and sent to the kitchen.`,{duration:6e3});let e=window.location.pathname;window.history.replaceState({},"",e)}else if("error"===s||"cancelled"===s){let t=e.get("reason")||"Unknown error";_.default.error(`‚ùå Payment ${"cancelled"===s?"cancelled":"failed"}: ${t}. Your order is saved as a draft - you can complete payment anytime.`,{duration:8e3});let a=window.location.pathname;window.history.replaceState({},"",a)}}},[]),(0,t.useEffect)(()=>{l?.address?G((0,C.parseAddressString)(l.address)):G((0,C.parseAddressString)(null))},[l?.address]),(0,t.useEffect)(()=>{if(!e?.user?.id)return;let s=async()=>{M(!0);try{let s=(0,p.getSupabaseClient)(),{data:t,error:a}=await s.from("orders").select(`
            *,
            order_items (
              menu_item_id,
              quantity,
              price,
              menu_items (name)
            )
          `).eq("user_id",e.user.id).order("created_at",{ascending:!1}).limit(10);if(a){console.error("‚ùå Account Page: Error fetching orders:",a),_.default.error("Failed to load orders");return}u(t||[])}catch(e){console.error("Error fetching data:",e),_.default.error("Failed to load account data")}finally{M(!1)}};s();let t=(0,p.getSupabaseClient)().channel("user-orders").on("postgres_changes",{event:"*",schema:"public",table:"orders",filter:`user_id=eq.${e.user.id}`},s).subscribe();return()=>{t.unsubscribe()}},[e?.user?.id,ea]);let en=async()=>{if(e){et(!0);try{let s=(0,C.serializeAddress)(V),t=await b(e.user.id,"address",s);if(!t.success)throw Error(t.error||"Address update failed");_.default.success("Address updated successfully!"),await d(),K(!1),er(e=>e+1)}catch(e){console.error("‚ùå Address update error:",e),_.default.error("Failed to update address")}finally{et(!1)}}},el=e=>{if("address"===e)K(!0);else{let s="full_name"===e?l?.full_name||"":"phone"===e&&l?.phone||"";Y({field:e,value:s,saving:!1})}},ec=()=>{Y({field:null,value:"",saving:!1})},eo=async()=>{if(e&&q.field){Y(e=>({...e,saving:!0}));try{let s=await b(e.user.id,q.field,q.value||null);if(!s.success)throw Error(s.error||"Update failed");_.default.success(`${q.field.replace("_"," ")} updated successfully!`),await d(),ec()}catch(e){console.error("‚ùå Field update error:",e),_.default.error(`Failed to update ${q.field.replace("_"," ")}`)}finally{Y(e=>({...e,saving:!1}))}}},ex=e=>{switch(e.toLowerCase()){case"pending":return"bg-yellow-500 text-yellow-50";case"confirmed":return"bg-blue-500 text-blue-50";case"preparing":return"bg-orange-500 text-orange-50";case"ready":return"bg-green-500 text-green-50";case"completed":return"bg-gray-500 text-gray-50";case"cancelled":return"bg-red-500 text-red-50";default:return"bg-gray-400 text-gray-50"}},em=(e,s)=>new Date(s?`${e}T${s}`:e).toLocaleString("en-ZA",{dateStyle:"medium",timeStyle:"short"});return e?f?(0,s.jsx)("div",{className:"min-h-screen bg-darkBg p-6",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)("div",{className:"w-48 h-12 bg-gradient-to-r from-neonCyan/30 via-neonPink/30 to-neonCyan/30 rounded-lg shimmer mx-auto"}),(0,s.jsx)("div",{className:"w-64 h-4 bg-gray-700 rounded shimmer mx-auto"})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"flex space-x-4",children:Array.from({length:3}).map((e,t)=>(0,s.jsx)("div",{className:"w-24 h-10 bg-gray-700 rounded-lg shimmer"},t))})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:3}).map((e,t)=>(0,s.jsxs)("div",{className:"bg-gray-800/50 p-6 rounded-xl border border-gray-700/50 space-y-4 animate-pulse",style:{animationDelay:`${.1*t}s`},children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-neonCyan/30 to-neonPink/30 rounded-full shimmer"}),(0,s.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,s.jsx)("div",{className:"w-3/4 h-4 bg-gray-700 rounded shimmer"}),(0,s.jsx)("div",{className:"w-1/2 h-3 bg-gray-700 rounded shimmer"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"w-full h-3 bg-gray-700 rounded shimmer"}),(0,s.jsx)("div",{className:"w-2/3 h-3 bg-gray-700 rounded shimmer"})]})]},t))}),(0,s.jsx)(I.OrderStatusSkeleton,{})]})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-darkBg p-6",children:[(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold bg-neon-gradient bg-clip-text text-transparent mb-2",children:"My Account"}),(0,s.jsxs)("p",{className:"text-gray-400",children:["Welcome back,"," ",l?.full_name||c?.email?.split("@")[0]||"Customer","!"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["User ID: ",e?.user?.id," | Email: ",e?.user?.email]})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1 sm:gap-2 bg-gray-800 p-1 rounded-lg",children:[{id:"active",label:"Active Orders",icon:B.Clock,shortLabel:"Active"},{id:"drafts",label:"Draft Orders",icon:D.Edit2,shortLabel:"Drafts"},{id:"profile",label:"My Profile",icon:o.User,shortLabel:"Profile"},{id:"notifications",label:"Notifications",icon:R.Bell,shortLabel:"Notify"},{id:"orders",label:"Order History",icon:E.Receipt,shortLabel:"History"}].map(({id:e,label:t,icon:a,shortLabel:r})=>(0,s.jsxs)("button",{onClick:()=>$(e),className:`flex-1 min-w-[60px] flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 sm:py-3 rounded-md text-xs sm:text-sm font-medium transition-all ${U===e?"bg-neonCyan text-black":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[(0,s.jsx)(a,{className:"h-4 w-4 flex-shrink-0"}),(0,s.jsx)("span",{className:"hidden xs:inline",children:t}),(0,s.jsx)("span",{className:"xs:hidden",children:r})]},e))}),"active"===U&&(0,s.jsxs)(i.Card,{className:"bg-gray-800 border-gray-600",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsxs)(i.CardTitle,{className:"text-orange-400 flex items-center gap-2",children:[(0,s.jsx)(B.Clock,{className:"h-5 w-5"}),"Active Orders"]}),(0,s.jsx)(i.CardDescription,{children:"Track your current orders from kitchen to pickup/delivery"})]}),(0,s.jsx)(i.CardContent,{children:0===h.filter(e=>e.status&&["confirmed","preparing","ready"].includes(e.status.toLowerCase())).length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(B.Clock,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:"No active orders"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Your active orders will appear here once you place an order"})]}):(0,s.jsx)("div",{className:"space-y-4",children:h.filter(e=>e.status&&["confirmed","preparing","ready"].includes(e.status.toLowerCase())).map(e=>(0,s.jsxs)("div",{className:"border-2 border-orange-500/30 bg-orange-900/10 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-semibold text-white",children:["Order #",e.order_number||e.id.slice(-8)]}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[e.created_at?em(e.created_at):"Date unknown","‚Ä¢ Pickup"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)(N.Badge,{className:`${ex(e.status||"pending")} mb-2 animate-pulse`,children:e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"Unknown"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["R",e.total_amount?.toFixed(2)||"0.00"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-400 bg-gray-700/50 p-3 rounded",children:[(0,s.jsxs)("div",{className:`flex flex-col items-center ${"confirmed"===e.status?"text-orange-400":"text-green-400"}`,children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-current mb-1"}),(0,s.jsx)("span",{children:"Confirmed"})]}),(0,s.jsx)("div",{className:"flex-1 h-px bg-gray-600 mx-2"}),(0,s.jsxs)("div",{className:`flex flex-col items-center ${"preparing"===e.status?"text-orange-400":"ready"===e.status?"text-green-400":"text-gray-500"}`,children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-current mb-1"}),(0,s.jsx)("span",{children:"Preparing"})]}),(0,s.jsx)("div",{className:"flex-1 h-px bg-gray-600 mx-2"}),(0,s.jsxs)("div",{className:`flex flex-col items-center ${"ready"===e.status?"text-green-400":"text-gray-500"}`,children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-current mb-1"}),(0,s.jsx)("span",{children:"Ready"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-300",children:"Items:"}),e.order_items.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between text-sm bg-gray-700 p-2 rounded",children:[(0,s.jsxs)("span",{className:"text-gray-300",children:[e.menu_items?.name||`Item #${e.menu_item_id}`," ","√ó ",e.quantity]}),(0,s.jsxs)("span",{className:"text-white",children:["R",((e.price||0)*(e.quantity||0)).toFixed(2)]})]},t))]}),e.special_instructions&&(0,s.jsxs)("div",{className:"bg-gray-700 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-300",children:"Special Instructions:"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:e.special_instructions})]})]},e.id))})})]}),"drafts"===U&&(0,s.jsxs)(i.Card,{className:"bg-gray-800 border-gray-600",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsxs)(i.CardTitle,{className:"text-yellow-400 flex items-center gap-2",children:[(0,s.jsx)(D.Edit2,{className:"h-5 w-5"}),"Draft Orders"]}),(0,s.jsx)(i.CardDescription,{children:"Complete payment for these orders to send them to the kitchen"})]}),(0,s.jsx)(i.CardContent,{children:0===h.filter(e=>e.status&&["draft","pending"].includes(e.status.toLowerCase())).length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(D.Edit2,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:"No draft orders"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Orders pending payment will appear here"})]}):(0,s.jsx)("div",{className:"space-y-4",children:h.filter(e=>e.status&&["draft","pending"].includes(e.status.toLowerCase())).map(t=>(0,s.jsxs)("div",{className:"border-2 border-yellow-500/30 bg-yellow-900/10 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-semibold text-white",children:["Order #",t.order_number||t.id.slice(-8)]}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[t.created_at?em(t.created_at):"Date unknown","‚Ä¢ Pickup"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)(N.Badge,{className:`${ex(t.status||"pending")} mb-2`,children:"failed"===t.payment_status?"Payment Failed":"Awaiting Payment"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["R",t.total_amount?.toFixed(2)||"0.00"]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-300",children:"Items:"}),t.order_items.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between text-sm bg-gray-700 p-2 rounded",children:[(0,s.jsxs)("span",{className:"text-gray-300",children:[e.menu_items?.name||`Item #${e.menu_item_id}`," ","√ó ",e.quantity]}),(0,s.jsxs)("span",{className:"text-white",children:["R",((e.price||0)*(e.quantity||0)).toFixed(2)]})]},t))]}),t.special_instructions&&(0,s.jsxs)("div",{className:"bg-gray-700 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-300",children:"Special Instructions:"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:t.special_instructions})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row gap-2 pt-3 border-t border-gray-600",children:[(0,s.jsx)(n.Button,{className:"flex-1 bg-green-600 hover:bg-green-700 text-white text-sm",onClick:async()=>{try{let s=await fetch("/api/orders/retry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:t.id,userId:e.user.id})}),a=await s.json();a.success&&a.orderItems?(m(a.orderItems),x.push("/ordering"),_.default.success(`Order #${a.orderNumber||t.order_number||t.id.slice(-8)} loaded to cart!`)):_.default.error(a.error||"Failed to load order")}catch(e){console.error("‚ùå Load order error:",e),_.default.error("Failed to load order. Please try again.")}},children:"Complete Payment"}),(0,s.jsx)(n.Button,{variant:"outline",className:"flex-1 border-red-500 text-red-400 hover:bg-red-500 hover:text-white text-sm whitespace-nowrap",onClick:async()=>{if(confirm(`Are you sure you want to cancel Order #${t.order_number||t.id.slice(-8)}? This action cannot be undone.`))try{let s=await y(t.id,e.user.id);s.success?(_.default.success(`Order #${t.order_number||t.id.slice(-8)} canceled successfully`),er(e=>e+1)):_.default.error(s.error||"Failed to cancel order")}catch(e){console.error("‚ùå Cancel order error:",e),_.default.error("Failed to cancel order. Please try again.")}},children:"Cancel Order"})]})]},t.id))})})]}),"profile"===U&&(0,s.jsxs)(i.Card,{className:"bg-gray-800 border-gray-600",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsxs)(i.CardTitle,{className:"text-neonCyan flex items-center gap-2",children:[(0,s.jsx)(o.User,{className:"h-5 w-5"}),"My Profile"]}),(0,s.jsx)(i.CardDescription,{children:"Click the edit button next to any field to update your information"})]}),(0,s.jsxs)(i.CardContent,{children:[(0,s.jsx)("div",{className:"flex justify-center mb-8",children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"w-[120px] h-[120px] rounded-full bg-gradient-to-br from-neonCyan to-neonPink flex items-center justify-center border-4 border-neonCyan shadow-lg",children:(0,s.jsx)("span",{className:"text-black font-bold text-4xl",children:(l?.full_name||c?.email||"U").charAt(0).toUpperCase()})})})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0 p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,s.jsx)(S.Mail,{className:"h-5 w-5 text-neonCyan flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Email Address"}),(0,s.jsx)("p",{className:"text-white font-medium truncate",children:c?.email})]})]}),(0,s.jsx)(N.Badge,{variant:"outline",className:"border-gray-500 text-gray-400 text-xs whitespace-nowrap self-start sm:self-center",children:"Cannot be changed"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(o.User,{className:"h-5 w-5 text-neonPink"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Full Name"}),"full_name"===q.field?(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)(j.Input,{value:q.value,onChange:e=>Y(s=>({...s,value:e.target.value})),className:"bg-gray-600 border-gray-500 text-white focus:border-neonPink",placeholder:"Enter your full name",disabled:q.saving}),(0,s.jsx)(n.Button,{size:"sm",onClick:eo,disabled:q.saving,className:"bg-green-600 hover:bg-green-700 text-white",children:q.saving?(0,s.jsx)(B.Clock,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(O.Save,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:ec,disabled:q.saving,className:"border-gray-500 text-gray-400 hover:bg-gray-600",children:(0,s.jsx)(T.X,{className:"h-4 w-4"})})]}):(0,s.jsx)("p",{className:"text-white font-medium",children:l?.full_name||"Not set"})]})]}),"full_name"!==q.field&&(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>el("full_name"),className:"border-neonPink text-neonPink hover:bg-neonPink hover:text-black",children:(0,s.jsx)(D.Edit2,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(A.Phone,{className:"h-5 w-5 text-yellow-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Phone Number"}),"phone"===q.field?(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)(j.Input,{value:q.value,onChange:e=>Y(s=>({...s,value:e.target.value})),className:"bg-gray-600 border-gray-500 text-white focus:border-yellow-500",placeholder:"Enter your phone number",type:"tel",disabled:q.saving}),(0,s.jsx)(n.Button,{size:"sm",onClick:eo,disabled:q.saving,className:"bg-green-600 hover:bg-green-700 text-white",children:q.saving?(0,s.jsx)(B.Clock,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(O.Save,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:ec,disabled:q.saving,className:"border-gray-500 text-gray-400 hover:bg-gray-600",children:(0,s.jsx)(T.X,{className:"h-4 w-4"})})]}):(0,s.jsx)("p",{className:"text-white font-medium",children:l?.phone||"Not set"})]})]}),"phone"!==q.field&&(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>el("phone"),className:"border-yellow-500 text-yellow-500 hover:bg-yellow-500 hover:text-black",children:(0,s.jsx)(D.Edit2,{className:"h-4 w-4"})})]}),W?(0,s.jsxs)("div",{className:"space-y-4 p-4 bg-gray-900/30 rounded-lg border border-purple-400/30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,s.jsx)(F.MapPin,{className:"h-5 w-5 text-purple-400"}),(0,s.jsx)("h3",{className:"text-white font-medium",children:"Update Delivery Address"})]}),(0,s.jsx)(w.default,{address:Q,onChange:e=>{ee(e),e&&G((0,v.validatedToEnhanced)(e))},required:!1}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end pt-4 border-t border-gray-700",children:[(0,s.jsxs)(n.Button,{onClick:en,disabled:es||!Q,className:"bg-green-600 hover:bg-green-700 text-white",children:[es?(0,s.jsx)(B.Clock,{className:"h-4 w-4 animate-spin mr-2"}):(0,s.jsx)(O.Save,{className:"h-4 w-4 mr-2"}),"Save Address"]}),(0,s.jsxs)(n.Button,{variant:"outline",onClick:()=>{l?.address?G((0,C.parseAddressString)(l.address)):G((0,C.parseAddressString)(null)),K(!1)},disabled:es,className:"border-gray-500 text-gray-400 hover:bg-gray-600",children:[(0,s.jsx)(T.X,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]}):(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(F.MapPin,{className:"h-5 w-5 text-purple-400"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Delivery Address"}),(0,s.jsx)("p",{className:"text-white font-medium",children:l?.address?(0,C.formatAddressForDisplay)((0,C.parseAddressString)(l.address)):"Not set"}),V.isRobertsEstateResident&&(0,s.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,s.jsx)(L.CheckCircle,{className:"h-3 w-3 text-green-400"}),(0,s.jsx)("span",{className:"text-xs text-green-400",children:"Roberts Estate Verified"})]})]})]}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>el("address"),className:"border-purple-400 text-purple-400 hover:bg-purple-400 hover:text-black",children:(0,s.jsx)(D.Edit2,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-8",children:[(0,s.jsx)("div",{className:"flex items-center gap-3 p-4 bg-gray-700 rounded-lg",children:(0,s.jsxs)(N.Badge,{variant:"outline",className:`${l?.is_admin?"border-red-500 text-red-400":l?.is_staff?"border-yellow-500 text-yellow-400":"border-green-500 text-green-400"}`,children:[(0,s.jsx)(o.User,{className:"h-4 w-4 mr-2"}),l?.is_admin?"Administrator":l?.is_staff?"Staff Member":"Customer"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-gray-700 rounded-lg",children:[(0,s.jsx)(B.Clock,{className:"h-5 w-5 text-purple-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Member Since"}),(0,s.jsx)("p",{className:"text-white font-medium",children:l?.created_at?new Date(l.created_at).toLocaleDateString("en-ZA",{year:"numeric",month:"long",day:"numeric"}):"Unknown"})]})]})]}),(0,s.jsx)("div",{className:"mt-12",children:H?(0,s.jsx)("div",{className:"p-4 sm:p-6 bg-red-900/20 border-2 border-red-500/30 rounded-lg space-y-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-red-500/20 rounded-full flex-shrink-0",children:(0,s.jsx)(T.X,{className:"h-5 w-5 text-red-400"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-red-400 mb-2",children:"Delete Account"}),1===J&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:"Permanently delete your account and all associated data. This action cannot be undone."}),(0,s.jsxs)("ul",{className:"text-xs sm:text-sm text-gray-400 space-y-1 mb-4 list-disc list-inside",children:[(0,s.jsx)("li",{children:"All personal information will be deleted"}),(0,s.jsx)("li",{children:"Order history will be removed"}),(0,s.jsx)("li",{children:"You will be immediately signed out"}),(0,s.jsx)("li",{children:"Active orders will be cancelled"})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row gap-2",children:[(0,s.jsxs)(n.Button,{variant:"outline",className:"border-red-500 text-red-400 hover:bg-red-500 hover:text-white text-sm",onClick:()=>X(2),children:[(0,s.jsx)(T.X,{className:"h-4 w-4 mr-2"}),"Continue to Delete"]}),(0,s.jsx)(n.Button,{variant:"outline",className:"border-gray-500 text-gray-400 hover:bg-gray-600 text-sm",onClick:()=>{z(!1),X(0)},children:"Cancel"})]})]}),2===J&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-red-500/10 border border-red-500/50 rounded p-3 sm:p-4 mb-4",children:[(0,s.jsx)("p",{className:"text-sm sm:text-base font-bold text-red-300 mb-2",children:"‚ö†Ô∏è Final Warning"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-300 mb-2",children:"Are you absolutely sure? This will permanently delete:"}),(0,s.jsxs)("ul",{className:"text-xs sm:text-sm text-gray-400 space-y-1 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Your profile and personal information"}),(0,s.jsx)("li",{children:"All order history and data"}),(0,s.jsx)("li",{children:"Saved addresses and preferences"}),(0,s.jsx)("li",{children:"Notification settings"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row gap-2",children:[(0,s.jsxs)(n.Button,{variant:"outline",className:"border-red-600 bg-red-600/20 text-red-300 hover:bg-red-600 hover:text-white text-sm font-bold",onClick:()=>X(3),children:[(0,s.jsx)(T.X,{className:"h-4 w-4 mr-2"}),"Yes, Delete Everything"]}),(0,s.jsx)(n.Button,{variant:"outline",className:"border-gray-500 text-gray-400 hover:bg-gray-600 text-sm",onClick:()=>{z(!1),X(0)},children:"Cancel"})]})]}),3===J&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-red-600/20 border-2 border-red-600 rounded p-3 sm:p-4 mb-4",children:[(0,s.jsx)("p",{className:"text-sm sm:text-base font-bold text-red-200 mb-2",children:"üö® FINAL CONFIRMATION"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-red-100 mb-3",children:"This is your last chance to cancel. Click the button below to permanently delete your account."}),(0,s.jsx)("p",{className:"text-xs text-red-200 font-mono bg-black/30 p-2 rounded",children:"This action is irreversible. All data will be lost forever."})]}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row gap-2",children:[(0,s.jsxs)(n.Button,{variant:"outline",className:"border-red-700 bg-red-700 text-white hover:bg-red-800 text-sm font-bold",onClick:async()=>{try{let s=(0,p.getSupabaseClient)(),t=await fetch("/api/account/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.user.id})}),a=await t.json();if(!a.success)throw Error(a.error||"Failed to delete account");await s.auth.signOut(),_.default.success("Account deleted successfully. You have been signed out."),x.push("/")}catch(e){console.error("‚ùå Delete account error:",e),_.default.error("Failed to delete account. Please contact support.")}},children:[(0,s.jsx)(T.X,{className:"h-4 w-4 mr-2"}),"DELETE MY ACCOUNT"]}),(0,s.jsx)(n.Button,{variant:"outline",className:"border-gray-500 text-gray-400 hover:bg-gray-600 text-sm",onClick:()=>{z(!1),X(0)},children:"Cancel"})]})]})]})]})}):(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-red-900/20 border-2 border-red-500/30 rounded-lg hover:bg-red-900/30 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(T.X,{className:"h-5 w-5 text-red-400 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Danger Zone"}),(0,s.jsx)("p",{className:"text-white font-medium",children:"Delete Account"})]})]}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>{z(!0),X(1)},className:"border-red-500 text-red-400 hover:bg-red-500/20",children:(0,s.jsx)(D.Edit2,{className:"h-4 w-4"})})]})})]})]})]}),"notifications"===U&&(0,s.jsxs)(i.Card,{className:"bg-gray-800 border-gray-600",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsxs)(i.CardTitle,{className:"text-neonCyan flex items-center gap-2",children:[(0,s.jsx)(R.Bell,{className:"h-5 w-5"}),"Notification Settings"]}),(0,s.jsx)(i.CardDescription,{children:"Manage your notification preferences and subscriptions"})]}),(0,s.jsxs)(i.CardContent,{className:"space-y-8",children:[(0,s.jsx)("div",{children:(0,s.jsx)(ei,{})}),(0,s.jsx)("div",{className:"border-t border-gray-700"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,s.jsx)(R.Bell,{className:"h-5 w-5 text-neonPink"}),"Notification History"]}),(0,s.jsx)(ed,{})]})]})]}),"orders"===U&&(0,s.jsxs)(i.Card,{className:"bg-gray-800 border-gray-600",children:[(0,s.jsxs)(i.CardHeader,{children:[(0,s.jsxs)(i.CardTitle,{className:"text-neonPink flex items-center gap-2",children:[(0,s.jsx)(E.Receipt,{className:"h-5 w-5"}),"Order History"]}),(0,s.jsx)(i.CardDescription,{children:"View your recent orders and their status"})]}),(0,s.jsx)(i.CardContent,{children:0===h.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(P.ShoppingBag,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:"No orders yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Your order history will appear here"})]}):(0,s.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,s.jsxs)("div",{className:"border border-gray-600 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-semibold text-white",children:["Order #",e.order_number||e.id.slice(-8)]}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[e.created_at?em(e.created_at):"Date unknown","‚Ä¢ Pickup"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)(N.Badge,{className:`${ex(e.status||"pending")} mb-2`,children:e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"Unknown"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["R",e.total_amount?.toFixed(2)||"0.00"]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-300",children:"Items:"}),e.order_items.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between text-sm bg-gray-700 p-2 rounded",children:[(0,s.jsxs)("span",{className:"text-gray-300",children:[e.menu_items?.name||`Item #${e.menu_item_id}`," ","√ó ",e.quantity]}),(0,s.jsxs)("span",{className:"text-white",children:["R",((e.price||0)*(e.quantity||0)).toFixed(2)]})]},t))]}),e.special_instructions&&(0,s.jsxs)("div",{className:"bg-gray-700 p-3 rounded",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-300",children:"Special Instructions:"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:e.special_instructions})]})]},e.id))})})]})]}),h.length>0&&(0,s.jsx)(Z,{autoShow:!0,onPermissionGranted:()=>{_.default.success("Notifications enabled! You'll be notified when your orders are ready.",{duration:5e3,style:{background:"#10b981",color:"white"}})},onDismiss:()=>{}})]}):(0,s.jsx)(g,{title:"Account Access Required",message:"Please sign in to view and manage your account information, order history, and personal details.",feature:"account"})}e.s(["default",()=>ex],119172)}]);

//# debugId=10efdf12-a37b-7b5f-e82c-9e445f34f0fb
//# sourceMappingURL=6c8f3ff51ff6edec.js.map